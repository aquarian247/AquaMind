# Generated by Django 4.2.11 on 2025-11-03 11:15

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import simple_history.models


class Migration(migrations.Migration):

    replaces = [
        ("batch", "0001_initial"),
        ("batch", "0002_add_multicontainer_models"),
        ("batch", "0003_update_batchtransfer"),
        ("batch", "0004_remove_batch_container"),
        ("batch", "0005_remove_container_fields"),
        ("batch", "0006_batchcontainerassignment_lifecycle_stage"),
        ("batch", "0007_alter_growthsample_options_remove_growthsample_batch_and_more"),
        ("batch", "0008_alter_growthsample_avg_length_cm_and_more"),
        ("batch", "0009_growthsample_sampling_event_id_and_more"),
        ("batch", "0010_remove_growthsample_batch_growt_sample__9efd52_idx_and_more"),
        ("batch", "0011_growthsample_sampling_event_id"),
        ("batch", "0012_remove_growthsample_sampling_event_id_and_more"),
        ("batch", "0013_batchcontainerassignment_avg_weight_g_and_more"),
        ("batch", "0014_remove_batch_avg_weight_g_remove_batch_biomass_kg_and_more"),
        ("batch", "0015_update_feedstock_timestamps"),
        ("batch", "0016_historicalbatch"),
        ("batch", "0017_add_last_weighing_date"),
        ("batch", "0018_create_missing_historical_tables"),
        ("batch", "0019_create_batchtransfer_historical_table"),
        ("batch", "0020_create_missing_historical_tables_part2"),
        ("batch", "0021_add_history_to_observation_models"),
        ("batch", "0022_add_history_tracking"),
        ("batch", "0023_batchtransferworkflow_historicaltransferaction_and_more"),
        ("batch", "0024_remove_batchtransfer"),
        ("batch", "0025_add_individual_growth_observations"),
    ]

    dependencies = [
        ("infrastructure", "0001_initial"),
        ("finance", "0004_bi_delivery_views"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ("infrastructure", "0005_update_feedstock_timestamps"),
    ]

    operations = [
        migrations.CreateModel(
            name="Batch",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("batch_number", models.CharField(max_length=50, unique=True)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("ACTIVE", "Active"),
                            ("COMPLETED", "Completed"),
                            ("TERMINATED", "Terminated"),
                        ],
                        default="ACTIVE",
                        max_length=20,
                    ),
                ),
                (
                    "population_count",
                    models.PositiveIntegerField(
                        validators=[django.core.validators.MinValueValidator(1)]
                    ),
                ),
                ("biomass_kg", models.DecimalField(decimal_places=2, max_digits=10)),
                ("avg_weight_g", models.DecimalField(decimal_places=2, max_digits=10)),
                ("start_date", models.DateField()),
                ("expected_end_date", models.DateField(blank=True, null=True)),
                ("actual_end_date", models.DateField(blank=True, null=True)),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "container",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="batches",
                        to="infrastructure.container",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="Species",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("name", models.CharField(max_length=100, unique=True)),
                ("scientific_name", models.CharField(max_length=200, unique=True)),
                ("description", models.TextField(blank=True)),
                (
                    "optimal_temperature_min",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum optimal temperature in °C",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_temperature_max",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum optimal temperature in °C",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_oxygen_min",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum optimal oxygen level in mg/L",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_ph_min",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum optimal pH level",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_ph_max",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum optimal pH level",
                        max_digits=5,
                        null=True,
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name_plural": "Species",
                "ordering": ["name"],
            },
        ),
        migrations.CreateModel(
            name="MortalityEvent",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("event_date", models.DateField()),
                (
                    "count",
                    models.PositiveIntegerField(help_text="Number of mortalities"),
                ),
                (
                    "biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Estimated biomass lost in kg",
                        max_digits=10,
                    ),
                ),
                (
                    "cause",
                    models.CharField(
                        choices=[
                            ("DISEASE", "Disease"),
                            ("HANDLING", "Handling"),
                            ("PREDATION", "Predation"),
                            ("ENVIRONMENTAL", "Environmental"),
                            ("UNKNOWN", "Unknown"),
                            ("OTHER", "Other"),
                        ],
                        default="UNKNOWN",
                        max_length=20,
                    ),
                ),
                ("description", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "batch",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="mortality_events",
                        to="batch.batch",
                    ),
                ),
            ],
            options={
                "verbose_name_plural": "Mortality events",
            },
        ),
        migrations.CreateModel(
            name="LifeCycleStage",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("name", models.CharField(max_length=100, unique=True)),
                (
                    "order",
                    models.PositiveSmallIntegerField(
                        help_text="Order in lifecycle (1, 2, 3, etc.)"
                    ),
                ),
                ("description", models.TextField(blank=True)),
                (
                    "expected_weight_min_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum expected weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "expected_weight_max_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum expected weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "expected_length_min_cm",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum expected length in centimeters",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "expected_length_max_cm",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum expected length in centimeters",
                        max_digits=10,
                        null=True,
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "species",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="lifecycle_stages",
                        to="batch.species",
                    ),
                ),
            ],
            options={
                "ordering": ["species", "order"],
                "unique_together": {("species", "order")},
            },
        ),
        migrations.CreateModel(
            name="GrowthSample",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("sample_date", models.DateField()),
                (
                    "sample_size",
                    models.PositiveIntegerField(help_text="Number of fish sampled"),
                ),
                (
                    "avg_weight_g",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Average weight in grams",
                        max_digits=10,
                    ),
                ),
                (
                    "avg_length_cm",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Average length in centimeters",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "std_deviation_weight",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Standard deviation of weight",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "std_deviation_length",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Standard deviation of length",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "min_weight_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "max_weight_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "condition_factor",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Condition factor (K)",
                        max_digits=10,
                        null=True,
                    ),
                ),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "batch",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="growth_samples",
                        to="batch.batch",
                    ),
                ),
            ],
            options={
                "ordering": ["batch", "-sample_date"],
            },
        ),
        migrations.CreateModel(
            name="BatchTransfer",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "transfer_type",
                    models.CharField(
                        choices=[
                            ("CONTAINER", "Container Transfer"),
                            ("LIFECYCLE", "Lifecycle Stage Change"),
                            ("SPLIT", "Batch Split"),
                            ("MERGE", "Batch Merge"),
                        ],
                        max_length=20,
                    ),
                ),
                ("transfer_date", models.DateField()),
                (
                    "source_count",
                    models.PositiveIntegerField(
                        help_text="Population count before transfer"
                    ),
                ),
                (
                    "transferred_count",
                    models.PositiveIntegerField(help_text="Number of fish transferred"),
                ),
                (
                    "mortality_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Number of mortalities during transfer"
                    ),
                ),
                (
                    "source_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass before transfer in kg",
                        max_digits=10,
                    ),
                ),
                (
                    "transferred_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass transferred in kg",
                        max_digits=10,
                    ),
                ),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "destination_batch",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfers_in",
                        to="batch.batch",
                    ),
                ),
                (
                    "destination_container",
                    models.ForeignKey(
                        blank=True,
                        help_text="New container after transfer",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfers_as_destination",
                        to="infrastructure.container",
                    ),
                ),
                (
                    "destination_lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        help_text="New lifecycle stage after transfer",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfers_as_destination",
                        to="batch.lifecyclestage",
                    ),
                ),
                (
                    "source_batch",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfers_out",
                        to="batch.batch",
                    ),
                ),
                (
                    "source_container",
                    models.ForeignKey(
                        help_text="Container before transfer",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfers_as_source",
                        to="infrastructure.container",
                    ),
                ),
                (
                    "source_lifecycle_stage",
                    models.ForeignKey(
                        help_text="Lifecycle stage before transfer",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfers_as_source",
                        to="batch.lifecyclestage",
                    ),
                ),
            ],
        ),
        migrations.AddField(
            model_name="batch",
            name="lifecycle_stage",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="batches",
                to="batch.lifecyclestage",
            ),
        ),
        migrations.AddField(
            model_name="batch",
            name="species",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="batches",
                to="batch.species",
            ),
        ),
        migrations.AddField(
            model_name="batch",
            name="batch_type",
            field=models.CharField(
                choices=[("STANDARD", "Standard"), ("MIXED", "Mixed Population")],
                default="STANDARD",
                max_length=20,
            ),
        ),
        migrations.CreateModel(
            name="BatchContainerAssignment",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "population_count",
                    models.PositiveIntegerField(
                        validators=[django.core.validators.MinValueValidator(0)]
                    ),
                ),
                ("biomass_kg", models.DecimalField(decimal_places=2, max_digits=10)),
                ("assignment_date", models.DateField()),
                (
                    "is_active",
                    models.BooleanField(
                        default=True,
                        help_text="Whether this assignment is current/active",
                    ),
                ),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "batch",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="container_assignments",
                        to="batch.batch",
                    ),
                ),
                (
                    "container",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="batch_assignments",
                        to="infrastructure.container",
                    ),
                ),
            ],
            options={
                "ordering": ["-assignment_date"],
            },
        ),
        migrations.AddConstraint(
            model_name="batchcontainerassignment",
            constraint=models.UniqueConstraint(
                condition=models.Q(("is_active", True)),
                fields=("batch", "container"),
                name="unique_active_batch_container",
            ),
        ),
        migrations.CreateModel(
            name="BatchComposition",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "percentage",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Percentage of this source batch in the mixed batch",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(0),
                            django.core.validators.MaxValueValidator(100),
                        ],
                    ),
                ),
                (
                    "population_count",
                    models.PositiveIntegerField(
                        help_text="Number of fish from this source batch in the mixed batch",
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass from this source batch in the mixed batch",
                        max_digits=10,
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "mixed_batch",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="components",
                        to="batch.batch",
                    ),
                ),
                (
                    "source_batch",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="mixed_into",
                        to="batch.batch",
                    ),
                ),
            ],
            options={
                "verbose_name_plural": "Batch compositions",
                "ordering": ["-percentage"],
            },
        ),
        migrations.AlterModelOptions(
            name="batchtransfer",
            options={"ordering": ["-transfer_date"]},
        ),
        migrations.AddField(
            model_name="batchtransfer",
            name="is_emergency_mixing",
            field=models.BooleanField(
                default=False, help_text="Whether this was an emergency mixing/transfer"
            ),
        ),
        migrations.AlterField(
            model_name="batchtransfer",
            name="transfer_type",
            field=models.CharField(
                choices=[
                    ("CONTAINER", "Container Transfer"),
                    ("LIFECYCLE", "Lifecycle Stage Change"),
                    ("SPLIT", "Batch Split"),
                    ("MERGE", "Batch Merge"),
                    ("MIXED_TRANSFER", "Mixed Batch Transfer"),
                ],
                max_length=20,
            ),
        ),
        migrations.AlterField(
            model_name="batchtransfer",
            name="destination_batch",
            field=models.ForeignKey(
                blank=True,
                help_text="Destination batch for merges or new batch for splits; may be null for simple transfers",
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="transfers_in",
                to="batch.batch",
            ),
        ),
        migrations.AddField(
            model_name="batchtransfer",
            name="source_assignment",
            field=models.ForeignKey(
                blank=True,
                help_text="Source batch-container assignment",
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="transfers_as_source",
                to="batch.batchcontainerassignment",
            ),
        ),
        migrations.AddField(
            model_name="batchtransfer",
            name="destination_assignment",
            field=models.ForeignKey(
                blank=True,
                help_text="Destination batch-container assignment",
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="transfers_as_destination",
                to="batch.batchcontainerassignment",
            ),
        ),
        migrations.RemoveField(
            model_name="batch",
            name="container",
        ),
        migrations.AlterModelOptions(
            name="batchtransfer",
            options={"ordering": ["-transfer_date", "-created_at"]},
        ),
        migrations.RemoveField(
            model_name="batchtransfer",
            name="destination_container",
        ),
        migrations.RemoveField(
            model_name="batchtransfer",
            name="source_container",
        ),
        migrations.AlterField(
            model_name="batchtransfer",
            name="is_emergency_mixing",
            field=models.BooleanField(
                default=False,
                help_text="Whether this was an emergency mixing of different batches",
            ),
        ),
        migrations.AddField(
            model_name="batchcontainerassignment",
            name="lifecycle_stage",
            field=models.ForeignKey(
                default=1,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="container_assignments",
                to="batch.lifecyclestage",
            ),
            preserve_default=False,
        ),
        migrations.AlterModelOptions(
            name="growthsample",
            options={"ordering": ["assignment", "-sample_date"]},
        ),
        migrations.RemoveField(
            model_name="growthsample",
            name="batch",
        ),
        migrations.AddField(
            model_name="growthsample",
            name="assignment",
            field=models.ForeignKey(
                help_text="The specific container assignment this sample was taken from",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="growth_samples",
                to="batch.batchcontainerassignment",
            ),
            preserve_default=False,
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="avg_length_cm",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Average length in centimeters (calculated from individual lengths if provided)",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="condition_factor",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Condition factor (K) - calculated",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="std_deviation_length",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Standard deviation of length (calculated from individual lengths if provided)",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="avg_length_cm",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Average length (cm) calculated from individual measurements if provided, otherwise manually entered.",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="avg_weight_g",
            field=models.DecimalField(
                decimal_places=2,
                help_text="Average weight (g) calculated from individual measurements if provided, otherwise manually entered.",
                max_digits=10,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="condition_factor",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Average Condition Factor (K) calculated from individual measurements if provided.",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="std_deviation_length",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Standard deviation of length (cm) calculated from individual measurements if provided.",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="std_deviation_weight",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Standard deviation of weight (g) calculated from individual measurements if provided.",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AddField(
            model_name="growthsample",
            name="sampling_event_id",
            field=models.BigIntegerField(
                blank=True,
                db_index=True,
                help_text="Shared identifier for associating growth and health data in sampling events.",
                null=True,
            ),
        ),
        migrations.AddIndex(
            model_name="growthsample",
            index=models.Index(
                fields=["sample_date"], name="batch_growt_sample__9efd52_idx"
            ),
        ),
        migrations.RemoveIndex(
            model_name="growthsample",
            name="batch_growt_sample__9efd52_idx",
        ),
        migrations.RemoveField(
            model_name="growthsample",
            name="sampling_event_id",
        ),
        migrations.AlterField(
            model_name="growthsample",
            name="notes",
            field=models.TextField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name="batchcontainerassignment",
            name="avg_weight_g",
            field=models.DecimalField(
                blank=True,
                decimal_places=2,
                help_text="Average weight in grams per fish at the time of this specific assignment or update.",
                max_digits=10,
                null=True,
            ),
        ),
        migrations.AddField(
            model_name="batchcontainerassignment",
            name="departure_date",
            field=models.DateField(
                blank=True,
                help_text="Date when this specific assignment ended (e.g., fish moved out or population became zero)",
                null=True,
            ),
        ),
        migrations.AlterField(
            model_name="batchcontainerassignment",
            name="biomass_kg",
            field=models.DecimalField(
                decimal_places=2,
                help_text="Total biomass in kilograms. Calculated if population_count and avg_weight_g are provided.",
                max_digits=10,
            ),
        ),
        migrations.RemoveField(
            model_name="batch",
            name="avg_weight_g",
        ),
        migrations.RemoveField(
            model_name="batch",
            name="biomass_kg",
        ),
        migrations.RemoveField(
            model_name="batch",
            name="population_count",
        ),
        migrations.AlterField(
            model_name="batchcontainerassignment",
            name="batch",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="batch_assignments",
                to="batch.batch",
            ),
        ),
        migrations.AlterField(
            model_name="batchcontainerassignment",
            name="container",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="container_assignments",
                to="infrastructure.container",
            ),
        ),
        migrations.CreateModel(
            name="HistoricalBatch",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                ("batch_number", models.CharField(db_index=True, max_length=50)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("ACTIVE", "Active"),
                            ("COMPLETED", "Completed"),
                            ("TERMINATED", "Terminated"),
                        ],
                        default="ACTIVE",
                        max_length=20,
                    ),
                ),
                (
                    "batch_type",
                    models.CharField(
                        choices=[
                            ("STANDARD", "Standard"),
                            ("MIXED", "Mixed Population"),
                        ],
                        default="STANDARD",
                        max_length=20,
                    ),
                ),
                ("start_date", models.DateField()),
                ("expected_end_date", models.DateField(blank=True, null=True)),
                ("actual_end_date", models.DateField(blank=True, null=True)),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.lifecyclestage",
                    ),
                ),
                (
                    "species",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.species",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical batch",
                "verbose_name_plural": "historical batchs",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddField(
            model_name="batchcontainerassignment",
            name="last_weighing_date",
            field=models.DateField(
                blank=True,
                help_text="Date of the most recent growth sample (weighing) for this assignment",
                null=True,
            ),
        ),
        migrations.CreateModel(
            name="HistoricalBatchContainerAssignment",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                (
                    "population_count",
                    models.PositiveIntegerField(
                        validators=[django.core.validators.MinValueValidator(0)]
                    ),
                ),
                (
                    "avg_weight_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Average weight in grams per fish at the time of this specific assignment or update.",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Total biomass in kilograms. Calculated if population_count and avg_weight_g are provided.",
                        max_digits=10,
                    ),
                ),
                ("assignment_date", models.DateField()),
                (
                    "departure_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when this specific assignment ended (e.g., fish moved out or population became zero)",
                        null=True,
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        default=True,
                        help_text="Whether this assignment is current/active",
                    ),
                ),
                (
                    "last_weighing_date",
                    models.DateField(
                        blank=True,
                        help_text="Date of the most recent growth sample (weighing) for this assignment",
                        null=True,
                    ),
                ),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
                (
                    "container",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="infrastructure.container",
                    ),
                ),
                (
                    "lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.lifecyclestage",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical batch container assignment",
                "verbose_name_plural": "historical batch container assignments",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalBatchTransfer",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                (
                    "transfer_type",
                    models.CharField(
                        choices=[
                            ("CONTAINER", "Container Transfer"),
                            ("LIFECYCLE", "Lifecycle Stage Change"),
                            ("SPLIT", "Batch Split"),
                            ("MERGE", "Batch Merge"),
                            ("MIXED_TRANSFER", "Mixed Batch Transfer"),
                        ],
                        max_length=20,
                    ),
                ),
                ("transfer_date", models.DateField()),
                (
                    "source_count",
                    models.PositiveIntegerField(
                        help_text="Population count before transfer"
                    ),
                ),
                (
                    "transferred_count",
                    models.PositiveIntegerField(help_text="Number of fish transferred"),
                ),
                (
                    "mortality_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Number of mortalities during transfer"
                    ),
                ),
                (
                    "source_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass before transfer in kg",
                        max_digits=10,
                    ),
                ),
                (
                    "transferred_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass transferred in kg",
                        max_digits=10,
                    ),
                ),
                (
                    "is_emergency_mixing",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this was an emergency mixing of different batches",
                    ),
                ),
                ("notes", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "source_batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
                (
                    "destination_batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Destination batch for merges or new batch for splits; may be null for simple transfers",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
                (
                    "source_assignment",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Source batch-container assignment",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batchcontainerassignment",
                    ),
                ),
                (
                    "destination_assignment",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Destination batch-container assignment",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batchcontainerassignment",
                    ),
                ),
                (
                    "source_lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Lifecycle stage before transfer",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.lifecyclestage",
                    ),
                ),
                (
                    "destination_lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="New lifecycle stage after transfer",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.lifecyclestage",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical batch transfer",
                "verbose_name_plural": "historical batch transfers",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalGrowthSample",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                ("sample_date", models.DateField()),
                (
                    "sample_size",
                    models.PositiveIntegerField(help_text="Number of fish sampled"),
                ),
                (
                    "avg_weight_g",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Average weight (g) calculated from individual measurements if provided, otherwise manually entered.",
                        max_digits=10,
                    ),
                ),
                (
                    "avg_length_cm",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Average length (cm) calculated from individual measurements if provided, otherwise manually entered.",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "std_deviation_weight",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Standard deviation of weight (g) calculated from individual measurements if provided.",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "std_deviation_length",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Standard deviation of length (cm) calculated from individual measurements if provided.",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "min_weight_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "max_weight_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "condition_factor",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Average Condition Factor (K) calculated from individual measurements if provided.",
                        max_digits=10,
                        null=True,
                    ),
                ),
                ("notes", models.TextField(blank=True, null=True)),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "assignment",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="The specific container assignment this sample was taken from",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batchcontainerassignment",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical growth sample",
                "verbose_name_plural": "historical growth samples",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalMortalityEvent",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                ("event_date", models.DateField()),
                (
                    "count",
                    models.PositiveIntegerField(help_text="Number of mortalities"),
                ),
                (
                    "biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Estimated biomass lost in kg",
                        max_digits=10,
                    ),
                ),
                (
                    "cause",
                    models.CharField(
                        choices=[
                            ("DISEASE", "Disease"),
                            ("HANDLING", "Handling"),
                            ("PREDATION", "Predation"),
                            ("ENVIRONMENTAL", "Environmental"),
                            ("UNKNOWN", "Unknown"),
                            ("OTHER", "Other"),
                        ],
                        default="UNKNOWN",
                        max_length=20,
                    ),
                ),
                ("description", models.TextField(blank=True)),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical mortality event",
                "verbose_name_plural": "historical Mortality events",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalSpecies",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                ("name", models.CharField(db_index=True, max_length=100)),
                ("scientific_name", models.CharField(db_index=True, max_length=200)),
                ("description", models.TextField(blank=True)),
                (
                    "optimal_temperature_min",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum optimal temperature in °C",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_temperature_max",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum optimal temperature in °C",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_oxygen_min",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum optimal oxygen level in mg/L",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_ph_min",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum optimal pH level",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "optimal_ph_max",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum optimal pH level",
                        max_digits=5,
                        null=True,
                    ),
                ),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "historical species",
                "verbose_name_plural": "historical Species",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalLifeCycleStage",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                ("name", models.CharField(db_index=True, max_length=100)),
                (
                    "order",
                    models.PositiveSmallIntegerField(
                        help_text="Order in lifecycle (1, 2, 3, etc.)"
                    ),
                ),
                ("description", models.TextField(blank=True)),
                (
                    "expected_weight_min_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum expected weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "expected_weight_max_g",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum expected weight in grams",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "expected_length_min_cm",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Minimum expected length in centimeters",
                        max_digits=10,
                        null=True,
                    ),
                ),
                (
                    "expected_length_max_cm",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Maximum expected length in centimeters",
                        max_digits=10,
                        null=True,
                    ),
                ),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "species",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.species",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical life cycle stage",
                "verbose_name_plural": "historical life cycle stages",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalBatchComposition",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                (
                    "percentage",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Percentage of this source batch in the mixed batch",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "population_count",
                    models.PositiveIntegerField(
                        help_text="Number of fish from this source batch in the mixed batch",
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass from this source batch in the mixed batch",
                        max_digits=10,
                    ),
                ),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "mixed_batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
                (
                    "source_batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical batch composition",
                "verbose_name_plural": "historical Batch compositions",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="BatchTransferWorkflow",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "workflow_number",
                    models.CharField(
                        help_text="Unique workflow identifier (e.g., TRF-2024-001)",
                        max_length=50,
                        unique=True,
                    ),
                ),
                (
                    "workflow_type",
                    models.CharField(
                        choices=[
                            ("LIFECYCLE_TRANSITION", "Lifecycle Stage Transition"),
                            ("CONTAINER_REDISTRIBUTION", "Container Redistribution"),
                            ("EMERGENCY_CASCADE", "Emergency Cascading Transfer"),
                            ("PARTIAL_HARVEST", "Partial Harvest Preparation"),
                        ],
                        default="LIFECYCLE_TRANSITION",
                        max_length=30,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("DRAFT", "Draft - Planning"),
                            ("PLANNED", "Planned - Ready to Execute"),
                            ("IN_PROGRESS", "In Progress"),
                            ("COMPLETED", "Completed"),
                            ("CANCELLED", "Cancelled"),
                        ],
                        default="DRAFT",
                        max_length=20,
                    ),
                ),
                (
                    "planned_start_date",
                    models.DateField(help_text="Planned start date for the workflow"),
                ),
                (
                    "planned_completion_date",
                    models.DateField(
                        blank=True, help_text="Planned completion date", null=True
                    ),
                ),
                (
                    "actual_start_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when first action was executed",
                        null=True,
                    ),
                ),
                (
                    "actual_completion_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when last action was executed",
                        null=True,
                    ),
                ),
                (
                    "total_source_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Total fish in source containers"
                    ),
                ),
                (
                    "total_transferred_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Total fish transferred"
                    ),
                ),
                (
                    "total_mortality_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Total mortalities during transfer"
                    ),
                ),
                (
                    "total_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Total biomass transferred (kg)",
                        max_digits=12,
                    ),
                ),
                (
                    "total_actions_planned",
                    models.PositiveIntegerField(
                        default=0, help_text="Total number of actions planned"
                    ),
                ),
                (
                    "actions_completed",
                    models.PositiveIntegerField(
                        default=0, help_text="Number of actions completed"
                    ),
                ),
                (
                    "completion_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Completion percentage (0-100)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(0),
                            django.core.validators.MaxValueValidator(100),
                        ],
                    ),
                ),
                (
                    "is_intercompany",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this transfer crosses subsidiary boundaries",
                    ),
                ),
                (
                    "source_subsidiary",
                    models.CharField(
                        blank=True,
                        help_text="Source subsidiary (derived from containers)",
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "dest_subsidiary",
                    models.CharField(
                        blank=True,
                        help_text="Destination subsidiary (derived from containers)",
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True, help_text="General notes about the workflow"
                    ),
                ),
                (
                    "cancellation_reason",
                    models.TextField(
                        blank=True, help_text="Reason for cancellation (if cancelled)"
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "batch",
                    models.ForeignKey(
                        help_text="Batch being transferred",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfer_workflows",
                        to="batch.batch",
                    ),
                ),
                (
                    "completed_by",
                    models.ForeignKey(
                        blank=True,
                        help_text="User who completed this workflow",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="completed_transfer_workflows",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "dest_lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        help_text="Destination lifecycle stage (if stage transition)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="workflows_as_destination",
                        to="batch.lifecyclestage",
                    ),
                ),
                (
                    "finance_transaction",
                    models.ForeignKey(
                        blank=True,
                        help_text="Associated intercompany transaction (if applicable)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfer_workflows",
                        to="finance.intercompanytransaction",
                    ),
                ),
                (
                    "initiated_by",
                    models.ForeignKey(
                        help_text="User who created this workflow",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="initiated_transfer_workflows",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "source_lifecycle_stage",
                    models.ForeignKey(
                        help_text="Source lifecycle stage",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="workflows_as_source",
                        to="batch.lifecyclestage",
                    ),
                ),
            ],
            options={
                "verbose_name": "Batch Transfer Workflow",
                "verbose_name_plural": "Batch Transfer Workflows",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="HistoricalTransferAction",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                (
                    "action_number",
                    models.PositiveIntegerField(
                        help_text="Sequence number within workflow (1, 2, 3...)"
                    ),
                ),
                (
                    "source_population_before",
                    models.PositiveIntegerField(
                        help_text="Population in source container before this action"
                    ),
                ),
                (
                    "transferred_count",
                    models.PositiveIntegerField(help_text="Number of fish to transfer"),
                ),
                (
                    "mortality_during_transfer",
                    models.PositiveIntegerField(
                        default=0, help_text="Number of mortalities during transfer"
                    ),
                ),
                (
                    "transferred_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass transferred (kg)",
                        max_digits=10,
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending - Not Started"),
                            ("IN_PROGRESS", "In Progress - Being Executed"),
                            ("COMPLETED", "Completed"),
                            ("FAILED", "Failed - Rolled Back"),
                            ("SKIPPED", "Skipped"),
                        ],
                        default="PENDING",
                        max_length=20,
                    ),
                ),
                (
                    "planned_date",
                    models.DateField(
                        blank=True, help_text="Planned execution date", null=True
                    ),
                ),
                (
                    "actual_execution_date",
                    models.DateField(
                        blank=True, help_text="Actual execution date", null=True
                    ),
                ),
                (
                    "transfer_method",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("NET", "Net Transfer"),
                            ("PUMP", "Pump Transfer"),
                            ("GRAVITY", "Gravity Transfer"),
                            ("MANUAL", "Manual Bucket Transfer"),
                        ],
                        help_text="Method used for transfer",
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "water_temp_c",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Water temperature during transfer (°C)",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "oxygen_level",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Oxygen level during transfer (mg/L)",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "execution_duration_minutes",
                    models.PositiveIntegerField(
                        blank=True,
                        help_text="Duration of transfer in minutes",
                        null=True,
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True, help_text="Notes about this specific action"
                    ),
                ),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "dest_assignment",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Destination batch-container assignment (created during execution)",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batchcontainerassignment",
                    ),
                ),
                (
                    "executed_by",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="User who executed this action",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "source_assignment",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Source batch-container assignment",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batchcontainerassignment",
                    ),
                ),
                (
                    "workflow",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Parent workflow this action belongs to",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batchtransferworkflow",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical Transfer Action",
                "verbose_name_plural": "historical Transfer Actions",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="HistoricalBatchTransferWorkflow",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                (
                    "workflow_number",
                    models.CharField(
                        db_index=True,
                        help_text="Unique workflow identifier (e.g., TRF-2024-001)",
                        max_length=50,
                    ),
                ),
                (
                    "workflow_type",
                    models.CharField(
                        choices=[
                            ("LIFECYCLE_TRANSITION", "Lifecycle Stage Transition"),
                            ("CONTAINER_REDISTRIBUTION", "Container Redistribution"),
                            ("EMERGENCY_CASCADE", "Emergency Cascading Transfer"),
                            ("PARTIAL_HARVEST", "Partial Harvest Preparation"),
                        ],
                        default="LIFECYCLE_TRANSITION",
                        max_length=30,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("DRAFT", "Draft - Planning"),
                            ("PLANNED", "Planned - Ready to Execute"),
                            ("IN_PROGRESS", "In Progress"),
                            ("COMPLETED", "Completed"),
                            ("CANCELLED", "Cancelled"),
                        ],
                        default="DRAFT",
                        max_length=20,
                    ),
                ),
                (
                    "planned_start_date",
                    models.DateField(help_text="Planned start date for the workflow"),
                ),
                (
                    "planned_completion_date",
                    models.DateField(
                        blank=True, help_text="Planned completion date", null=True
                    ),
                ),
                (
                    "actual_start_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when first action was executed",
                        null=True,
                    ),
                ),
                (
                    "actual_completion_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when last action was executed",
                        null=True,
                    ),
                ),
                (
                    "total_source_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Total fish in source containers"
                    ),
                ),
                (
                    "total_transferred_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Total fish transferred"
                    ),
                ),
                (
                    "total_mortality_count",
                    models.PositiveIntegerField(
                        default=0, help_text="Total mortalities during transfer"
                    ),
                ),
                (
                    "total_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Total biomass transferred (kg)",
                        max_digits=12,
                    ),
                ),
                (
                    "total_actions_planned",
                    models.PositiveIntegerField(
                        default=0, help_text="Total number of actions planned"
                    ),
                ),
                (
                    "actions_completed",
                    models.PositiveIntegerField(
                        default=0, help_text="Number of actions completed"
                    ),
                ),
                (
                    "completion_percentage",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Completion percentage (0-100)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(0),
                            django.core.validators.MaxValueValidator(100),
                        ],
                    ),
                ),
                (
                    "is_intercompany",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this transfer crosses subsidiary boundaries",
                    ),
                ),
                (
                    "source_subsidiary",
                    models.CharField(
                        blank=True,
                        help_text="Source subsidiary (derived from containers)",
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "dest_subsidiary",
                    models.CharField(
                        blank=True,
                        help_text="Destination subsidiary (derived from containers)",
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True, help_text="General notes about the workflow"
                    ),
                ),
                (
                    "cancellation_reason",
                    models.TextField(
                        blank=True, help_text="Reason for cancellation (if cancelled)"
                    ),
                ),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "batch",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Batch being transferred",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.batch",
                    ),
                ),
                (
                    "completed_by",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="User who completed this workflow",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "dest_lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Destination lifecycle stage (if stage transition)",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.lifecyclestage",
                    ),
                ),
                (
                    "finance_transaction",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Associated intercompany transaction (if applicable)",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="finance.intercompanytransaction",
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "initiated_by",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="User who created this workflow",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "source_lifecycle_stage",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="Source lifecycle stage",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.lifecyclestage",
                    ),
                ),
            ],
            options={
                "verbose_name": "historical Batch Transfer Workflow",
                "verbose_name_plural": "historical Batch Transfer Workflows",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name="TransferAction",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "action_number",
                    models.PositiveIntegerField(
                        help_text="Sequence number within workflow (1, 2, 3...)"
                    ),
                ),
                (
                    "source_population_before",
                    models.PositiveIntegerField(
                        help_text="Population in source container before this action"
                    ),
                ),
                (
                    "transferred_count",
                    models.PositiveIntegerField(help_text="Number of fish to transfer"),
                ),
                (
                    "mortality_during_transfer",
                    models.PositiveIntegerField(
                        default=0, help_text="Number of mortalities during transfer"
                    ),
                ),
                (
                    "transferred_biomass_kg",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Biomass transferred (kg)",
                        max_digits=10,
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending - Not Started"),
                            ("IN_PROGRESS", "In Progress - Being Executed"),
                            ("COMPLETED", "Completed"),
                            ("FAILED", "Failed - Rolled Back"),
                            ("SKIPPED", "Skipped"),
                        ],
                        default="PENDING",
                        max_length=20,
                    ),
                ),
                (
                    "planned_date",
                    models.DateField(
                        blank=True, help_text="Planned execution date", null=True
                    ),
                ),
                (
                    "actual_execution_date",
                    models.DateField(
                        blank=True, help_text="Actual execution date", null=True
                    ),
                ),
                (
                    "transfer_method",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("NET", "Net Transfer"),
                            ("PUMP", "Pump Transfer"),
                            ("GRAVITY", "Gravity Transfer"),
                            ("MANUAL", "Manual Bucket Transfer"),
                        ],
                        help_text="Method used for transfer",
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "water_temp_c",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Water temperature during transfer (°C)",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "oxygen_level",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Oxygen level during transfer (mg/L)",
                        max_digits=5,
                        null=True,
                    ),
                ),
                (
                    "execution_duration_minutes",
                    models.PositiveIntegerField(
                        blank=True,
                        help_text="Duration of transfer in minutes",
                        null=True,
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True, help_text="Notes about this specific action"
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "dest_assignment",
                    models.ForeignKey(
                        blank=True,
                        help_text="Destination batch-container assignment (created during execution)",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfer_actions_as_dest",
                        to="batch.batchcontainerassignment",
                    ),
                ),
                (
                    "executed_by",
                    models.ForeignKey(
                        blank=True,
                        help_text="User who executed this action",
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="executed_transfer_actions",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "source_assignment",
                    models.ForeignKey(
                        help_text="Source batch-container assignment",
                        on_delete=django.db.models.deletion.PROTECT,
                        related_name="transfer_actions_as_source",
                        to="batch.batchcontainerassignment",
                    ),
                ),
                (
                    "workflow",
                    models.ForeignKey(
                        help_text="Parent workflow this action belongs to",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="actions",
                        to="batch.batchtransferworkflow",
                    ),
                ),
            ],
            options={
                "verbose_name": "Transfer Action",
                "verbose_name_plural": "Transfer Actions",
                "ordering": ["workflow", "action_number"],
                "indexes": [
                    models.Index(
                        fields=["workflow", "status"],
                        name="batch_trans_workflo_34b086_idx",
                    ),
                    models.Index(
                        fields=["actual_execution_date"],
                        name="batch_trans_actual__96ce99_idx",
                    ),
                    models.Index(
                        fields=["status"], name="batch_trans_status_d4e717_idx"
                    ),
                ],
                "unique_together": {("workflow", "action_number")},
            },
        ),
        migrations.AddIndex(
            model_name="batchtransferworkflow",
            index=models.Index(
                fields=["batch", "status"], name="batch_batch_batch_i_01b738_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="batchtransferworkflow",
            index=models.Index(
                fields=["planned_start_date"], name="batch_batch_planned_bc83d0_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="batchtransferworkflow",
            index=models.Index(
                fields=["workflow_type"], name="batch_batch_workflo_faef0d_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="batchtransferworkflow",
            index=models.Index(fields=["status"], name="batch_batch_status_97e7a3_idx"),
        ),
        migrations.CreateModel(
            name="IndividualGrowthObservation",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "fish_identifier",
                    models.CharField(
                        help_text="Identifier for the fish (e.g., sequential number).",
                        max_length=50,
                    ),
                ),
                (
                    "weight_g",
                    models.DecimalField(
                        decimal_places=2, help_text="Weight in grams.", max_digits=10
                    ),
                ),
                (
                    "length_cm",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Length in centimeters.",
                        max_digits=10,
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "growth_sample",
                    models.ForeignKey(
                        help_text="The growth sample this observation belongs to.",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="individual_observations",
                        to="batch.growthsample",
                    ),
                ),
            ],
            options={
                "verbose_name": "Individual Growth Observation",
                "verbose_name_plural": "Individual Growth Observations",
                "ordering": ["growth_sample", "fish_identifier"],
                "unique_together": {("growth_sample", "fish_identifier")},
            },
        ),
        migrations.CreateModel(
            name="HistoricalIndividualGrowthObservation",
            fields=[
                (
                    "id",
                    models.BigIntegerField(
                        auto_created=True, blank=True, db_index=True, verbose_name="ID"
                    ),
                ),
                (
                    "fish_identifier",
                    models.CharField(
                        help_text="Identifier for the fish (e.g., sequential number).",
                        max_length=50,
                    ),
                ),
                (
                    "weight_g",
                    models.DecimalField(
                        decimal_places=2, help_text="Weight in grams.", max_digits=10
                    ),
                ),
                (
                    "length_cm",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Length in centimeters.",
                        max_digits=10,
                    ),
                ),
                ("created_at", models.DateTimeField(blank=True, editable=False)),
                ("updated_at", models.DateTimeField(blank=True, editable=False)),
                ("history_id", models.AutoField(primary_key=True, serialize=False)),
                ("history_date", models.DateTimeField(db_index=True)),
                ("history_change_reason", models.CharField(max_length=100, null=True)),
                (
                    "history_type",
                    models.CharField(
                        choices=[("+", "Created"), ("~", "Changed"), ("-", "Deleted")],
                        max_length=1,
                    ),
                ),
                (
                    "growth_sample",
                    models.ForeignKey(
                        blank=True,
                        db_constraint=False,
                        help_text="The growth sample this observation belongs to.",
                        null=True,
                        on_delete=django.db.models.deletion.DO_NOTHING,
                        related_name="+",
                        to="batch.growthsample",
                    ),
                ),
                (
                    "history_user",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="+",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "historical Individual Growth Observation",
                "verbose_name_plural": "historical Individual Growth Observations",
                "ordering": ("-history_date", "-history_id"),
                "get_latest_by": ("history_date", "history_id"),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
    ]
